---
title: ã€vueç³»åˆ—ã€‘å¼€å‘ç»„ä»¶ã€å°è£…æˆvueæ’ä»¶ã€ç¼–å†™æ–‡æ¡£ã€é…ç½®gh-pagesåˆ†æ”¯demoã€å‘å¸ƒnpmåŒ…ä¸€æ³¢æµ
date: 2020-06-15
tags: 
---

ä½ æ˜¯å¦‚ä½•ç•Œå®šè¦ä¸è¦é€ è½®å­çš„ï¼Ÿäºæˆ‘è€Œè¨€ï¼Œå°†éœ€è¦å¤šå¤„è°ƒç”¨çš„é‡å¤ä»£ç å°è£…æˆç»„ä»¶ã€æ’ä»¶ï¼ŒæŠŠç¹ççš„æ“ä½œæµç¨‹å¼€å‘æˆææ•ˆå·¥å…·ï¼Œåç»­èƒ½ç®€åŒ–å·¥ä½œé‡ï¼Œæé«˜å·¥ä½œæ•ˆç‡ï¼Œå°±å€¼å¾—é€ è½®å­ã€‚ä¸ºä¸šåŠ¡å°ç»„ä»¶ã€å°æ’ä»¶ï¼Œä¸ºææ•ˆé€ å·¥å…·ï¼Œåšæœ‰ä»·å€¼çš„äº‹ï¼Œæ‰èƒ½å®ç°è‡ªæˆ‘ä»·å€¼ã€‚

<!--more-->

ä½ æ˜¯å¦‚ä½•ç•Œå®šè¦ä¸è¦é€ è½®å­çš„ï¼Ÿäºæˆ‘è€Œè¨€ï¼Œå°†éœ€è¦å¤šå¤„è°ƒç”¨çš„é‡å¤ä»£ç å°è£…æˆç»„ä»¶ã€æ’ä»¶ï¼ŒæŠŠç¹ççš„æ“ä½œæµç¨‹å¼€å‘æˆææ•ˆå·¥å…·ï¼Œåç»­èƒ½ç®€åŒ–å·¥ä½œé‡ï¼Œæé«˜å·¥ä½œæ•ˆç‡ï¼Œå°±å€¼å¾—é€ è½®å­ã€‚ä¸ºä¸šåŠ¡å°ç»„ä»¶ã€å°æ’ä»¶ï¼Œä¸ºææ•ˆé€ å·¥å…·ï¼Œåšæœ‰ä»·å€¼çš„äº‹ï¼Œæ‰èƒ½å®ç°è‡ªæˆ‘ä»·å€¼ã€‚

æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ï¼Œè¿™æ¬¡é€ çš„ä»€ä¹ˆè½®å­ï¼Œé’ˆå¯¹æˆ‘ä»¬è¯·å‡å®¡æ‰¹çš„éœ€æ±‚ï¼Œè¯·å‡çš„æ—¶å€™é€‰æ‹©æ—¥æœŸé€‰æ‹©å™¨æ˜¯å¸¦ä¸Šä¸‹åˆçš„ï¼Œè¿™åœ¨ç§»åŠ¨ç«¯å¹¶ä¸å¤šè§ï¼Œé€šå¸¸æ˜¯æ—¥å†çš„å½¢å¼ï¼Œæˆ‘ä»¬çš„äº§å“è¦æ±‚pickeræ»šåŠ¨å™¨çš„å½¢å¼ã€‚æ‰¾äº†åŠå¤©éƒ½æ²¡æ‰¾åˆ°åˆé€‚çš„ã€‚

![](https://user-gold-cdn.xitu.io/2020/6/15/172b5cf1436e4626?w=696&h=536&f=png&s=83431)
å°±æ˜¯è¿™ç§æ—¥æœŸé€‰æ‹©å™¨ğŸ‘†ã€‚

å–ï¼Œå°±æ˜¯è¿™æ ·æ•ˆæœï¼Œæ²¡å¾—åŠæ³•ï¼Œåªèƒ½è‡ªå·±ä¸Šæ‰‹é€ ä¸€ä¸ªã€‚ä»¥ä¸‹å°±æ˜¯æˆ‘é€ è½®å­çš„è¿‡ç¨‹ã€‚ä»å…ˆå¼€å‘å¸¦åŠå¤©çš„æ—¥æœŸé€‰æ‹©å™¨ç»„ä»¶ï¼Œæ»¡è¶³éœ€æ±‚ä½¿ç”¨ï¼›ä¸šåŠ¡é‡Œå¤šå¤„ä½¿ç”¨ï¼Œå°è£…æˆvueæ’ä»¶ï¼›å°è£…å®Œæˆå‘ç°åŒ…å¤ªå¤§ï¼Œè¿›è€Œå¯¹æ’ä»¶ä¼˜åŒ–ï¼›ä¸€ä¸ªç²¾è‡´çš„vueæ’ä»¶å°è£…å®Œæˆåï¼Œç¼–å†™æ’ä»¶çš„ä½¿ç”¨æ–‡æ¡£ï¼Œæ–¹ä¾¿å¤§å®¶ä½¿ç”¨ï¼›ç„¶åä¸Šä¼ åˆ°githubï¼Œé…ç½®gh-pagesï¼Œå±•ç°åœ¨çº¿demoï¼›æœ€åå‘å¸ƒåˆ°npmï¼Œä¸€ä¸ªä¸‰æ–¹æ’ä»¶å°±å®Œæˆäº†ã€‚âœŒï¸âœŒï¸âœŒï¸

æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹å°è£…å¥½çš„å¸¦ä¸Šã€ä¸‹çš„æ—¥æœŸé€‰æ‹©å™¨ï¼Œæ€ä¹ˆç”¨ï¼ŸğŸ‘‡

# vue-halfday-datepicker 

> ä¸€ä¸ªç®€å•çš„åŸºäºvueçš„å¸¦ä¸Šã€ä¸‹åˆçš„æ—¥æœŸé€‰æ‹©å™¨

## Demo

[åœ¨çº¿åœ°å€ï¼šhttps://habc0807.github.io/vue-halfday-datepicker/index.html](https://habc0807.github.io/vue-halfday-datepicker/index.html)

## ç‰¹ç‚¹

- ç§»åŠ¨ç«¯
- å¸¦ä¸Šã€ä¸‹åˆ
- æ—¥æœŸé€‰æ‹©å™¨
- vueæ’ä»¶

## å®‰è£…

```
npm i vue-halfday-datepicker -D
cnpm i vue-halfday-datepicker -D
yarn add vue-halfday-datepicker -D
```

## å¼•å…¥å’Œæ³¨å†Œ 
åœ¨å•é¡µé¢åº”ç”¨çš„å…¥å£æ–‡ä»¶é‡Œå¼•å…¥å’Œæ³¨å†Œ

```javascript
import VueHalfdayDatepicker from 'vue-halfday-datepicker'
Vue.use(VueHalfdayDatepicker)
```

## ä½¿ç”¨ 

``` vue
<template>
  <div id="app">
    <h2>ä¸€ä¸ªåŸºäºvueçš„æ—¥æœŸé€‰æ‹©å™¨Demo</h2>

    <div class="pickerSelect" @click="onOpenPicker">{{ pickerValue }}</div>
    <vue-halfday-datepicker :show="isShow" @onConfirm="onConfirmHandle" @onCancel="onCancelHandle"/>
  </div>
</template>

<script>
export default {
  name: 'app',
  data () {
    return {
      isShow: false,
      pickerValue: 'æµ‹è¯•ä¸€ä¸‹ï¼šè¯·é€‰æ‹©'
    }
  },
  methods: {
    onOpenPicker(e) {
        this.isShow = true
    },
    onConfirmHandle(v) {
        this.value = v
        this.pickerValue = v
        this.isShow = false
    },
    onCancelHandle(e) {
        this.isShow = false
    }
  },
}
</script>
<style>
</style>
```

å¦‚æœè§‰å¾—æ’ä»¶è¿˜ä¸é”™ï¼Œå°±ç»™ä¸ªStarï¼ŒåŠ©åŠ›ä¸‹ï¼Œä½ çš„æ”¯æŒï¼Œæ˜¯æˆ‘è¾“å‡ºçš„åŠ¨åŠ›ï½ï½ï½
[github: vue-halfday-datepicker](https://github.com/habc0807/vue-halfday-datepicker)

# å¦‚ä½•å¼€å‘ä¸€ä¸ªå¸¦ä¸Šã€ä¸‹åˆçš„æ—¥æœŸé€‰æ‹©å™¨ç»„ä»¶

## å¯»æ‰¾è§£å†³æ–¹æ¡ˆ

æœ€åˆçš„æ—¶å€™ï¼Œæˆ‘æƒ³çœäº‹ï¼Œæ‰¾ä¸ªä¸‰æ–¹ç›´æ¥ç”¨ï¼Œåœ¨githubä¸Šæ‰’æ‹‰äº†åŠå¤©ï¼Œåˆæ‰’äº†vueçš„UIç»„ä»¶åº“ä»¬ï¼Œçœ‹äº†ä¸€åœˆï¼Œå‘ç°VUXçš„`datetime` å±…ç„¶æœ‰è¿™ä¸ªç»„ä»¶ã€‚å¼€æ£®ï¼Œèµ¶ç´§è¯•è¯•ï¼Œå¼€å§‹æŒ‰éœ€å¼•å…¥è¿™ä¸ªç»„ä»¶ï¼Œé€šè¿‡VUXå®˜ç½‘çš„[æ‰‹åŠ¨é…ç½®ä½¿ç”¨](https://doc.vux.li/zh-CN/install/manual-usage.html)ï¼Œé…ç½®çœŸç¹çï¼Œé‡ç‚¹é…å®Œè¿˜ä¸èƒ½ç”¨ã€‚å½“ç„¶æˆ‘ä¸ä¼šè½»æ˜“æ”¾å¼ƒçš„ï¼Œä»å¤´åˆ°å°¾æŒ‰ç…§é…ç½®å†æ¥ä¸€éï¼Œä¾æ—§ä¸å¥½ä½¿ã€‚

![](https://user-gold-cdn.xitu.io/2020/6/12/172a7826dd444cba?w=678&h=309&f=png&s=147876)
## äºŒæ¬¡å°è£…picker

æ²¡åŠæ³•ï¼Œæˆ‘æš‚æ—¶æ”¾å¼ƒäº†VUXã€‚å¦è¾Ÿæ·å¾„ï¼Œæ—¥æœŸé€‰æ‹©å™¨pickerï¼Œä¸ä¹Ÿæ˜¯pickerå—ï¼Œä¸ºä»€ä¹ˆä¸åŸºäºpickerçš„åŸºç¡€ä¸ŠåšäºŒæ¬¡å°è£…å‘¢ï¼Ÿ

äºæ˜¯æˆ‘æ‰¾åˆ°äº† `Mint UI`ï¼Œä½¿ç”¨å®ƒçš„ `picker` åšäºŒæ¬¡å°è£…ã€‚ä¸å¾—ä¸æ‰¿è®¤ [Mint UI çš„å¿«é€Ÿä¸Šæ‰‹æ–‡æ¡£](http://mint-ui.github.io/docs/#/zh-cn2/quickstart)å†™çš„å¾ˆèµï¼Œé…ç½®èµ·æ¥å¾ˆé¡ºæ‰‹ã€‚å› ä¸ºåªéœ€è¦ä½¿ç”¨ä¸€ä¸ªç»„ä»¶ï¼ŒæŒ‰éœ€å¼•å…¥éœ€è¦å€ŸåŠ© `babel-plugin-component` ï¼Œä»¥è¾¾åˆ°å‡å°é¡¹ç›®ä½“ç§¯çš„ç›®çš„ã€‚é¦–å…ˆï¼Œå®‰è£… `npm install babel-plugin-component -D
`ï¼Œç„¶åå°† `.babelrc` ä¿®æ”¹ä¸ºï¼š 

```
{
  "presets": [
    ["es2015", { "modules": false }]
  ],
  "plugins": [["component", [
    {
      "libraryName": "mint-ui",
      "style": true
    }
  ]]]
}
```

## æ—¥æœŸé€‰æ‹©å™¨å¦‚ä½•å¼€å‘

å½“ç„¶æœ€é‡è¦çš„æ˜¯ picker çš„ `slots` å››åˆ—æ•°ç»„çš„æ•°æ®å¤„ç†ï¼Œä»¥åŠ picker æ”¹å˜çš„æ•°æ®æ›´æ–°ã€‚å…ˆæ¥çœ‹çœ‹ `slots` :

```javascript
slots: [
    {
        flex: 1,
        values: yearsArr,
        className: 'slot1',
        textAlign: 'center',
        defaultIndex: defalutYear,
    }, 
    {
        flex: 1,
        values: monthsArr,
        className: 'slot2',
        textAlign: 'center',
        defaultIndex: defalutMonth
    },
    {
        flex: 1,
        values: daysArr,
        className: 'slot3',
        textAlign: 'center',
        defaultIndex: defalutDay
    },
    {
        flex: 1,
        values: noonArr,
        className: 'slot4',
        textAlign: 'center',
        defaultIndex: 0,
    }
]
```

æˆ‘ä»¬éœ€è¦å››åˆ—æ•°ç»„ï¼Œåˆ†åˆ«æ˜¯å¹´ä»½æ•°ç»„ï¼Œå½“å‰å¹´ä»½å¯¹åº”çš„æœˆä»½æ•°ç»„ï¼Œå½“å‰æœˆä»½å¯¹åº”çš„å¤©æ•°æ•°ç»„ï¼Œä»¥åŠä¸€ä¸ªä¸Šã€ä¸‹åˆæ•°ç»„ã€‚å…¶ä¸­æœˆä»½æ•°ç»„é€šå¸¸éƒ½æ˜¯ 1 ï½ 12æœˆï¼Œä¸Šã€ä¸‹åˆæ•°ç»„ä¹Ÿå¾ˆç®€å•ï¼Œå¹´ä»½æ•°ç»„æˆ‘ä»¬é»˜è®¤æŒ‡å®šå‰å10å¹´å°±å¤Ÿç”¨äº†ï¼Œéœ€è¦ç‰¹æ®Šè®¡ç®—çš„æ˜¯å¤©æ•°æ•°ç»„ã€‚å…¶å®è®¡ç®—è§„åˆ™å¤§è‡´æ˜¯æ˜¯å¦æ˜¯2æœˆï¼Œè‹¥æ˜¯é€šè¿‡æ˜¯å¦æ˜¯é—°å¹´è®¡ç®—å‡ºå¤©æ•°ï¼Œè‹¥ä¸æ˜¯ 4, 6, 9, 11æœˆä»½ä¸º30å¤©ï¼Œå…¶å®ƒæœˆä»½ä¸º31å¤©ã€‚å—¯ï¼Œå°±é…±ï¼Œæ¥çœ‹ä»£ç ğŸ‘‡ã€‚

```javascript
/**
 * æ˜¯å¦æ˜¯é—°å¹´
 * @param {*} year 
 */
function isLeapYear (year) {
  return year % 100 !== 0 && year % 4 === 0 || year % 400 === 0
}

/**
 * è®¡ç®—æ¯å¹´çš„æ¯ä¸ªæœˆçš„å¤©æ•°
 * @param {*} year 
 * @param {*} month 
 */
function getMaxDay (year, month) {
  year = parseFloat(year)
  month = parseFloat(month)
  if (month === 2) {
    return isLeapYear(year) ? 29 : 28
  }

  return [4, 6, 9, 11].indexOf(month) >= 0 ? 30 : 31
}
```

æ¯æ¬¡pickeræ›´æ–°ï¼Œé‡æ–°è®¡ç®—æ•°ç»„é‡Œçš„æ•°æ®å€¼ï¼ŒåŠæ—¶æ›´æ–°é€‰å‡ºçš„æ—¥æœŸã€‚ç»„ä»¶å°±å¼€å‘å®Œæˆï¼Œé‡Œé¢å…¶å®è¿˜æœ‰å¾ˆå¤šç»†èŠ‚åœ°æ–¹éœ€è¦æ³¨æ„ï¼Œæ¯”å¦‚é»˜è®¤æ˜¾ç¤ºï¼Œæ›´æ–°åçš„æ˜¾ç¤ºç­‰ï¼Œæˆ‘åªæ˜¯è¯´äº†è¯´ä¸»æµç¨‹ã€‚

# å¦‚ä½•å°è£…ä¸€ä¸ªvueæ’ä»¶ 

ç»„ä»¶å¼€å‘å®Œæˆäº†ï¼Œæˆ‘èŒç”Ÿäº†å°æ’ä»¶çš„æƒ³æ³•ã€‚é¦–å…ˆè¿™ä¸ªç»„ä»¶éœ€è¦å¼•ç”¨`mint-ui`ä¸‰æ–¹ï¼ŒæŒ‰éœ€å¼•å…¥ `picker`ï¼Œå…¶æ¬¡ï¼Œåœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ·»åŠ  `.babelrc` æ–‡ä»¶æ¥é…ç½®æŒ‰éœ€åŠ è½½ã€‚è¿™ä¸€äº›åˆ—çš„æ“ä½œï¼Œå¦‚æœåç»­æœ‰éœ€æ±‚æˆ–è€…å…¶ä»–å°ä¼™ä¼´ä¹Ÿè¦ç”¨å®ƒçš„è¯ï¼Œå°±ä¼šè§‰å¾—æ¯”è¾ƒéº»çƒ¦ã€‚æˆ‘ä»¬è¿™ä¸ªå¤šé¡µé¢åº”ç”¨ï¼Œå°±è¦æŠŠä¸Šè¿°çš„æµç¨‹å†æ“ä½œä¸€éã€‚è¿˜ä¸å¦‚å°è£…ä¸€ä¸ª vue æ’ä»¶ï¼Œç”¨ç€å¤šæ–¹ä¾¿ã€‚

ä»ä¸šåŠ¡çš„ä»·å€¼å‡ºå‘ï¼Œå€¼å¾—é€ ç«ç®­ï¼Œå¦‚æœèƒ½å°†ä»¥ä¸Šæµç¨‹å°è£…æˆ vue æ’ä»¶ï¼Œåç»­åªè¦å¼•å…¥ä½¿ç”¨å°±è¡Œäº†ã€‚é…ç½®æµç¨‹ï¼ŒæŒ‰éœ€åŠ è½½ä»€ä¹ˆçš„éƒ½æ”¾åˆ° vue æ’ä»¶é‡Œï¼Œä¸ºä¸šåŠ¡é€ è½®å­ï¼Œè¿™å°±æ˜¯æˆ‘è¦åšçš„äº‹æƒ…ã€‚

## é¡¹ç›®åˆå§‹åŒ– 

æŸ¥å°è£…vueæ’ä»¶çš„èµ„æ–™çš„æ—¶å€™ï¼Œçœ‹åˆ°æœ‰äººæ¨è `webpack-simple`ï¼Œæˆ‘å°±è¯•è¯•äº†è¯•ï¼Œè¿˜è›®å¥½ç”¨ã€‚é€šè¿‡ `vue init webpack-simple vue-æ’ä»¶å`ï¼Œåˆ›å»ºå‡ºå·² `vue-æ’ä»¶å`å‘½åçš„æ–‡ä»¶å¤¹ï¼Œé¡¹ç›®çš„ç›®å½•æ ‘å¦‚ä¸‹ã€‚

```
.
â”œâ”€â”€ README.md
â”œâ”€â”€ dist
â”œâ”€â”€ index.html
â”œâ”€â”€ package.json
â”œâ”€â”€ src
â”‚   â”œâ”€â”€ App.vue
â”‚   â”œâ”€â”€ assets
â”‚   â”‚   â””â”€â”€ logo.png
â”‚   â”œâ”€â”€ lib            
â”‚   â”‚   â”œâ”€â”€ VueHalfdayDatepicker.vue
â”‚   â”‚   â””â”€â”€ index.js
â”‚   â”œâ”€â”€ main.js
â””â”€â”€ webpack.config.js
```
å¾ˆç®€å•ï¼Œå‰ç«¯çš„çŒ¿çŒ¿ä»¬ä¸€çœ¼å°±èƒ½çœ‹çš„æ‡‚å§ï¼Œå…¶ä¸­srcä¸ºæºç éƒ¨åˆ†ï¼Œlibæ˜¯æ’ä»¶éƒ¨åˆ†ã€‚

## ä¿®æ”¹é…ç½®é¡¹

### ä¿®æ”¹package.json

ä¸»è¦æ›´æ”¹äº† `nameã€mainã€authorã€repository`ï¼Œå…·ä½“å¦‚ä¸‹ï¼š

- name æŒ‡å®šæ’ä»¶åç§°
- main æ’ä»¶æœ€åçš„æ„å»ºæ–‡ä»¶è·¯å¾„
- author ä½œè€…çš„åŸºæœ¬ä¿¡æ¯
- repository ä»“åº“çš„åŸºæœ¬ä¿¡æ¯

```json
{
  "name": "vue-halfday-datepicker",
  "description": "A date picker",
  "main": "dist/vue-halfday-datepicker.js",
  "version": "1.0.1",
  "author": "habc0807 <gao0807@foxmail.com>",
  "license": "MIT",
  "private": false,
  "scripts": {
    "dev": "cross-env NODE_ENV=development webpack-dev-server --open --hot",
    "build": "cross-env NODE_ENV=production webpack --progress --hide-modules"
  },
  "repository": {
    "type": "git",
    "url": "git+https://github.com/habc0807/vue-halfday-datepicker.git"
  },
  "browserslist": [
    "> 1%",
    "last 2 versions",
    "not ie <= 8"
  ],
  "devDependencies": {
    "babel-core": "^6.26.0",
    "babel-loader": "^7.1.2",
    "babel-plugin-component": "^1.1.1",
    "babel-preset-env": "^1.6.0",
    "babel-preset-stage-3": "^6.24.1",
    "cross-env": "^5.0.5",
    "css-loader": "^0.28.7",
    "file-loader": "^1.1.4",
    "mint-ui": "^2.2.13",
    "vue": "^2.5.11",
    "vue-loader": "^13.0.5",
    "vue-template-compiler": "^2.4.4",
    "webpack": "^3.6.0",
    "webpack-bundle-analyzer": "^3.8.0",
    "webpack-bundle-tracker": "^1.0.0-alpha.1",
    "webpack-dev-server": "^2.9.1"
  },
  "bugs": {
    "url": "https://github.com/habc0807/vue-halfday-datepicker/issues"
  },
  "homepage": "https://github.com/habc0807/vvue-halfday-datepicker#readme"
}
```

### ä¿®æ”¹ webpack.config.js

è¿™é‡Œæˆ‘ä»¬é¢„ç•™äº†é¡µé¢çš„å…¥å£ï¼Œå’Œæ’ä»¶çš„å…¥å£ï¼Œå…ˆä»¥ç»„ä»¶çš„å½¢å¼ä½¿ç”¨ï¼Œæ²¡æœ‰é—®é¢˜åï¼Œå†å°†ç»„ä»¶æ‰“åŒ…æˆæ’ä»¶ï¼Œå†åœ¨é¡µé¢ä¸­æŸ¥çœ‹å±•ç°æ•ˆæœï¼Œæˆ–è€…ä¿®å¤æ’ä»¶ä¸­çš„å°bugã€‚

```
entry: './src/main.js', // é¡µé¢çš„å…¥å£
  // entry: './src/lib/index.js', // æ’ä»¶çš„å…¥å£
output: {
    path: path.resolve(__dirname, './dist'),
    publicPath: '/dist/',
    filename: 'build.js', // é¡µé¢çš„ç”Ÿæˆæ–‡ä»¶
    // filename: 'vue-halfday-datepicker.js', // æ’ä»¶çš„ç”Ÿæˆæ–‡ä»¶
    libraryTarget: 'umd',
    umdNamedDefine: true
},
```

> åç»­åœ¨ä¼˜åŒ–æ’ä»¶çš„è¿‡ç¨‹ä¸­ï¼Œæ·»åŠ ä¸€äº›å…¶å®ƒé…ç½®ï¼Œæœ€ç»ˆçš„ `webpack.config.js` åœ¨æ’ä»¶ä¼˜åŒ–éƒ¨åˆ†ä¸­å±•ç¤ºã€‚

## å°è£…æ’ä»¶ 

`VueHalfdayDatepicker.vue` æ’ä»¶çš„å…·ä½“å†…å®¹å¦‚ä¸‹ï¼Œå…¶ä¸­éœ€è¦æ³¨æ„çš„åœ°æ–¹ï¼Œè¿™ä¸ªæ’ä»¶çš„å°è£…ä½¿ç”¨äº† `mint-ui` çš„ `mt-picker`ã€‚æˆ‘ä¸»è¦è¦åšçš„äº‹æƒ…å°±æ˜¯ picker çš„å››åˆ—æ•°ç»„ `slots`ï¼Œç¬¬ä¸€ä¸ªæ¨¡å—ä»‹ç»è¿‡ï¼Œè¿™é‡Œå°±ä¸èµ˜è¿°äº†ã€‚


```
<template>
    <div v-show="show" class="half-day-date-picker">
        <div class="bg"></div>
        <div class="select-date-container">
            <section class="picker-wrap">
                <div class="picker-toolbar">
                    <div class="btn cancel" @click="onCancel">å–æ¶ˆ</div>
                    <div class="btn confirm" @click="onConfirm">ç¡®å®š</div>
                </div>

                <mt-picker 
                    :valueKey="''"
                    :defaultIndex=10
                    :visibleItemCount=9
                    :slots="slots" 
                    @change="onValuesChange"
                ></mt-picker>
            </section>
        </div>
    </div>
</template>

<script>
import { Picker } from 'mint-ui'
import 'mint-ui/lib/style.css'

import {
    yearsArr,
    monthsArr,
    daysArr,
    noonArr,
    defalutYear,
    defalutMonth,
    defalutDay
} from '../tools/makeData.js'

export default {
    name: 'vue-halfday-datepicker',
    props: {
        show: {
            type: Boolean,
            required: true,
            default: () => null,
        }
    },
    components: {
        [Picker.name]: Picker,
    },
    data: function() {
        return {
            pickerValue: '',
            slots: [
                {
                    flex: 1,
                    values: yearsArr,
                    className: 'slot1',
                    textAlign: 'center',
                    defaultIndex: defalutYear,
                }, 
                {
                    flex: 1,
                    values: monthsArr,
                    className: 'slot2',
                    textAlign: 'center',
                    defaultIndex: defalutMonth
                },
                {
                    flex: 1,
                    values: daysArr,
                    className: 'slot3',
                    textAlign: 'center',
                    defaultIndex: defalutDay
                },
                {
                    flex: 1,
                    values: noonArr,
                    className: 'slot4',
                    textAlign: 'center',
                    defaultIndex: 0,
                }
            ],
        }
    },
    methods: {
        onOpenPicker(e) {
            this.$emit('onOpenPicker')
        },
        onConfirm(e) {
            this.$emit('onConfirm', this.pickerValue)
        },
        onCancel(e) {
            this.$emit('onCancel')
        },
        /** pickeræ”¹å˜çš„å¤„ç† */
        onValuesChange(picker, values) {
            // æŒ‰ç…§æ—¶é—´ç»„åˆå­—ç¬¦ä¸²
            const pickerValue = values[0] + '-' + values[1] + '-' + values[2] + ' ' + values[3]
            this.pickerValue = pickerValue
            this.$emit('onValuesChange', pickerValue)
        },
    },
}
</script>
<style scoped>
	// â€¦
</style>
```
å°†æ­¤ç»„ä»¶å°è£…æˆæ’ä»¶ï¼Œvueæ’ä»¶çš„æ ¼å¼è¦é€šè¿‡ `install` æ¥æŒ‚è½½ç»„ä»¶ï¼Œä½¿ç”¨ `Vue.component` æ¥æ³¨å†Œä¸€ä¸ªæ’ä»¶ï¼Œåœ¨å¤–éƒ¨ `use` ä¸€ä¸ªæ’ä»¶ï¼Œ `index.js` çš„å®Œæ•´å†…å®¹å¦‚ä¸‹ã€‚

```javascript
import VueHalfdayDatepicker from './VueHalfdayDatepicker.vue'

const datePicker = {
  install: function(Vue) {
    Vue.component(VueHalfdayDatepicker.name, VueHalfdayDatepicker)
  }
}

// è¿™é‡Œçš„åˆ¤æ–­å¾ˆé‡è¦
if (typeof window !== 'undefined' && window.Vue) { 
  window.Vue.use(datePicker) 
}
export default datePicker
```

## æµ‹è¯•æ’ä»¶

å¦‚ä½•æµ‹è¯•ä¸€ä¸ªæ’ä»¶å¼€å‘æ˜¯å¦æˆåŠŸå‘¢ï¼Œæˆ‘æ²¡æœ‰ç›´æ¥å»æ„å»ºæ’ä»¶ï¼Œè€Œæ˜¯ä»¥ç›´æ¥å¼•ç”¨æœ¬åœ°æ’ä»¶çš„æ–¹å¼ï¼Œåœ¨ `main.js` ä¸­å¼•å…¥æ’ä»¶

```javascript
import VueHalfdayDatepicker from '../dist/vue-halfday-datepicker.js'
Vue.use(VueHalfdayDatepicker)
```

åœ¨ `App.vue` ä¸­ä½¿ç”¨ç»„ä»¶

```vue
<template>
  <div id="app">
    <h2>ä¸€ä¸ªåŸºäºvueçš„æ—¥æœŸé€‰æ‹©å™¨Demo</h2>

    <div class="pickerSelect" @click="onOpenPicker">{{ pickerValue }}</div>
    <vue-halfday-datepicker :show="isShow" @onConfirm="onConfirmHandle" @onCancel="onCancelHandle"/>
  </div>
</template>

<script>
export default {
  name: 'app',
  data () {
    return {
      isShow: false,
      pickerValue: 'æµ‹è¯•ä¸€ä¸‹ï¼šè¯·é€‰æ‹©'
    }
  },
  methods: {
    onOpenPicker(e) {
        this.isShow = true
    },
    onConfirmHandle(v) {
        this.value = v
        this.pickerValue = v
        this.isShow = false
    },
    onCancelHandle(e) {
        this.isShow = false
    }
  },
}
</script>

<style>
	// â€¦
</style>
```
æ‰§è¡Œ `npm run dev`ï¼Œç´§æ¥ç€åœ¨é¡µé¢ä¸­æŸ¥çœ‹æ’ä»¶ï¼Œä¿®å¤æ’ä»¶bugç­‰ï¼Œåœ¨é¡µé¢ä¸­æŸ¥çœ‹æ²¡æœ‰é—®é¢˜äº†ã€‚æ¥ç€ä¿®æ”¹ `webpack.config.js` çš„å…¥å£æ–‡ä»¶ï¼Œå’Œç”Ÿæˆæ–‡ä»¶åç§°ã€‚

```
  // entry: './src/main.js', // é¡µé¢çš„å…¥å£
  entry: './src/lib/index.js', // æ’ä»¶çš„å…¥å£
  output: {
    path: path.resolve(__dirname, './dist'),
    publicPath: '/dist/',
    // filename: 'build.js', // é¡µé¢çš„ç”Ÿæˆæ–‡ä»¶
    filename: 'vue-halfday-datepicker.js', // æ’ä»¶çš„ç”Ÿæˆæ–‡ä»¶
    libraryTarget: 'umd',
    umdNamedDefine: true
},
```
æ‰§è¡Œ `npm run build`ï¼Œåœ¨ç›®å½• `dist`æ–‡ä»¶å¤¹ä¸‹ æ„å»ºç”Ÿæˆæ’ä»¶ `vue-halfday-datepicker.js`ã€‚ç„¶åå†é…ç½®å›é¡µé¢çš„æ„å»ºï¼ŒæŸ¥çœ‹æ’ä»¶æ•ˆæœã€‚

## æ’ä»¶ä¼˜åŒ–

ä¸€ä¸ªvueæ’ä»¶åŸºæœ¬ä¸Šå°±å¼€å‘å¥½äº†ï¼Œæˆ‘ä»¬æƒ³çœ‹çœ‹æ„å»ºç”Ÿæˆçš„æ’ä»¶å„ä¸ªæ¨¡å—çš„å¤§å°ï¼Œæœ‰å“ªäº›å¯ä¼˜åŒ–çš„ç©ºé—´ï¼Œå¯ä»¥å€Ÿç”¨ `webpack-bundle-analyzer` å¯è§†åŒ–å·¥å…·æŸ¥çœ‹ã€‚ åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹ä½¿ç”¨å‘½ä»¤è¡Œ `cnpm i webpack-bundle-analyzer`ï¼Œå» `webpack.config.js` ä¸­é…ç½® 


```
const BundleAnalyzerPlugin = require('webpack-bundle-analyzer').BundleAnalyzerPlugin;

plugins: [
    new BundleAnalyzerPlugin()
]
```

æ‰§è¡Œ `npm run dev`ï¼Œçœ‹åˆ°æ‰“åŒ…åçš„æ’ä»¶çš„å„ä¸ªæ¨¡å—çš„å¤§å°ã€‚æˆ‘ä»¬å‘ç°æ’ä»¶æŠŠ `vue` æ‰“åŒ…è¿›å»äº†ï¼Œæ˜¯å› ä¸º `mint-ui` å¼•å…¥äº† `vue`ã€‚æ’ä»¶å¤§å°ï¼ŒParsed size: 161.33kbã€‚

![](https://user-gold-cdn.xitu.io/2020/6/12/172a78d62d4af8b6?w=1000&h=532&f=jpeg&s=79418)

æˆ‘ä»¬é€šè¿‡é…ç½® `externals`æ¥é˜²æ­¢å°†æŸäº›Â importÂ çš„åŒ…(package)æ‰“åŒ…åˆ° bundle ä¸­ï¼Œè€Œæ˜¯åœ¨è¿è¡Œæ—¶(runtime)å†å»ä»å¤–éƒ¨è·å–è¿™äº›æ‰©å±•ä¾èµ–ã€‚é€šè¿‡è®¾ç½®  `externals` é˜²æ­¢æŠŠ `vue` æ‰“åŒ…è¿›å»ï¼Œæ‰“åŒ…åæ’ä»¶åŒ…å°äº†è®¸å¤šï¼ŒParsed size: 64.46kbã€‚

```
externals: {
    vue: 'Vue'
},
```

![](https://user-gold-cdn.xitu.io/2020/6/12/172a78dd5afdf605?w=1000&h=468&f=jpeg&s=65531)

# æ¨åˆ°githubä¸Šï¼Œåœ¨gh-pagesä¸Šé…ç½®demo

éƒ¨ç½²å¥½çš„[DEMOåœ°å€](https://habc0807.github.io/vue-halfday-datepicker/index.html)ï¼Œå¿«æ¥çœ‹çœ‹æ•ˆæœã€‚

çŒ¿çŒ¿ä»¬gitæ“ä½œéƒ½å¾ˆæºœï¼Œæˆ‘å°±ä¸èµ˜è¿°githubçš„åŸºæœ¬æ“ä½œäº†ï¼Œå½“æˆ‘ä»¬æŠŠæ’ä»¶åº“æ¨åˆ°githubä¹‹åï¼Œé»˜è®¤æ˜¯æ¨åˆ°masteråˆ†æ”¯ä¸Šï¼Œç„¶åæ–°å»ºåˆ†æ”¯ gh-pagesï¼Œå°†master åˆ†æ”¯ä¸Šçš„å†…å®¹merge åˆ°gh-pagesåˆ†æ”¯ä¸Šï¼Œå¹¶æäº¤åˆ°è¿œç¨‹ã€‚éœ€è¦æ³¨æ„çš„ç‚¹æ˜¯ gh-pages åˆ†æ”¯æ˜¯githubæä¾›çš„é™æ€ç½‘ç«™éƒ¨ç½²å™¨ï¼Œé»˜è®¤ä¼šè¯»å–é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ index.htmlï¼Œæˆ‘çš„index.html:

```html
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no,viewport-fit=cover">
    <title>vue-halfday-datepicker</title>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
  </head>
  <body>
    <div id="app"></div>
    <script src="./dist/build.js"></script>
  </body>
</html>
```

å…¶ä¸­ `<script src="./dist/build.js"></script>` é‡Œçš„ dist/build.js æ˜¯é¡µé¢çš„æ„å»ºæ–‡ä»¶ï¼Œæ³¨æ„ `.gitignore` ä¸­ä¸è¦é…ç½® `dist` æ–‡ä»¶ï¼Œä¸ç„¶ builds.js æ–‡ä»¶å°±è¯»å–ä¸åˆ°äº†ã€‚éƒ¨ç½²å¥½çš„[DEMOåœ°å€](https://habc0807.github.io/vue-halfday-datepicker/index.html)ï¼Œå¿«æ¥çœ‹çœ‹æ•ˆæœã€‚

# å‘å¸ƒæ’ä»¶ï¼Œå‘å¸ƒä¸€ä¸ªnpmåŒ…

å¨ƒå“ˆå“ˆï¼Œåˆ°æœ€åä¸€æ­¥äº†ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹æ€ä¹ˆå‘å¸ƒã€‚ç†Ÿæ‚‰è¯¥æµç¨‹çš„çŒ¿çŒ¿ä»¬ï¼Œå°±å¯ä»¥å¿½æ‚ è¯¥æ¨¡å—äº†ï¼Œå¦‚æœæœ¬æ–‡ï¼Œèƒ½å¸®åŠ©åˆ°ä½ ï¼Œå¯ä»¥ä¸ºæˆ‘åŠ©åŠ›ç‚¹èµã€‚ã€ä¸å®³è‡Šçš„è¦å…³æ³¨ï¼Œè¦èµï¼Œå˜»å˜»ï½ã€‘

## npmå®˜ç½‘æ³¨å†Œ

å»[npmå®˜ç½‘](https://www.npmjs.com/)æ³¨å†Œï¼Œæ³¨å†Œçš„æ—¶å€™ï¼Œè¦è®°ä½è‡ªå·±çš„ç”¨æˆ·åã€å¯†ç å’Œé‚®ç®±ï¼Œåé¢æˆ‘ä»¬è¿˜è¦ç”¨ã€‚

## npmåŒ…å‘å¸ƒ
å›åˆ°æˆ‘ä»¬vueæ’ä»¶çš„ä»“åº“æ ¹ç›®å½•ä¸‹ï¼Œæ‰“å¼€å‘½ä»¤è¡Œï¼Œè¾“å…¥å‘½ä»¤ `npm login` ï¼ŒæŒ‰ç…§æç¤ºè¾“å…¥ä½ çš„ç”¨æˆ·åå’Œå¯†ç ï¼Œå†æ‰§è¡Œ `npm publish` è¿›è¡Œå‘å¸ƒã€‚å‘å¸ƒæˆåŠŸï¼Œå‘½ä»¤é‡Œä¼šæ˜¾ç¤º npmçš„åŒ…åå’Œç‰ˆæœ¬å·ã€‚

![](https://user-gold-cdn.xitu.io/2020/6/12/172a790ccf97c486?w=1710&h=86&f=jpeg&s=27897)

> å‘åŒ…è¿‡ç¨‹ä¸­å¦‚æœé‡åˆ°åŒ…åŒåï¼Œæˆ–è€…ç‰ˆæœ¬å·æ²¡æ›´æ–°çš„å°é—®é¢˜ï¼Œå¯è‡ªè¡Œæœç´¢ï¼Œå¾ˆå®¹æ˜“è§£å†³çš„ã€‚

# æ€»ç»“

å¸Œæœ›èƒ½å¸®åŠ©å¤§å®¶ï¼Œäº†è§£ç¼–å†™æ’ä»¶çš„è¿‡ç¨‹å’Œæ€è·¯ï¼Œä½ ä¼šå‘ç°åœ¨ä¸šåŠ¡ä¸­é¨æ¸¸ï¼Œæ—¶è€Œåšäº›ä¸šåŠ¡æ’ä»¶æ›´èƒ½ä½“ç°åšä¸šåŠ¡çš„ä»·å€¼ã€‚å¿«å»è¯•è¯•å§ï¼Œä½ ä¹Ÿå¯ä»¥å†™å‡ºå„å¼å„æ ·çš„å°æ’ä»¶ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºè·Ÿæˆ‘æ²Ÿé€šäº¤æµã€‚



